<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Resume Ranker</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .upload-area {
        border: 2px dashed #cbd5e0;
        transition: all 0.3s ease;
        background: linear-gradient(145deg, #ffffff 0%, #f7fafc 100%);
      }
      .upload-area:hover {
        border-color: #4299e1;
        transform: translateY(-2px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }
      .progress-ring {
        transition: stroke-dashoffset 1s ease-in-out;
        transform: rotate(-90deg);
        transform-origin: 50% 50%;
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-in;
      }
      .animate-slide-up {
        animation: slideUp 0.5s ease-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      .glass-effect {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
      }
    </style>
  </head>
  <body
    class="bg-gradient-to-br from-blue-50 via-white to-purple-50 min-h-screen"
  >
    <div class="py-12 px-4 sm:px-6 lg:px-8 animate-fade-in">
      <div class="max-w-4xl mx-auto">
        <div class="text-center mb-12 animate-slide-up">
          <h1
            class="text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4"
          >
            Mechatronics-AI Resume Ranker
          </h1>
          <p class="text-xl text-gray-600">
            Upload your resume and let AI match you with your dream job
          </p>
        </div>

        <div
          class="glass-effect shadow-xl rounded-2xl p-8 mb-8 animate-slide-up"
          style="transition: all 0.3s ease"
        >
          <form id="uploadForm" class="space-y-8">
            <div>
              <label class="block text-lg font-semibold text-gray-700 mb-3"
                >Upload Resume</label
              >
              <div
                class="upload-area p-8 text-center cursor-pointer rounded-xl hover:bg-blue-50 transition-all duration-300"
              >
                <input
                  type="file"
                  id="resume"
                  name="resume"
                  accept=".pdf,.docx"
                  class="hidden"
                />
                <div class="space-y-3">
                  <div
                    class="w-20 h-20 mx-auto bg-blue-100 rounded-full flex items-center justify-center"
                  >
                    <svg
                      class="w-10 h-10 text-blue-600"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                      ></path>
                    </svg>
                  </div>
                  <div class="text-lg font-medium text-gray-700" id="fileName">
                    Drop your resume here or click to upload
                  </div>
                  <div class="text-sm text-gray-500">
                    .pdf or .docx files only
                  </div>
                </div>
              </div>
            </div>

            <div>
              <label
                for="jobDescription"
                class="block text-lg font-semibold text-gray-700 mb-3"
                >Job Description</label
              >
              <textarea
                id="jobDescription"
                name="jobDescription"
                rows="6"
                class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:ring focus:ring-blue-200 transition duration-200 resize-none"
                placeholder="Paste the job description here..."
              ></textarea>
            </div>

            <div class="flex justify-center">
              <button
                type="submit"
                class="px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Analyze Resume
              </button>
            </div>
          </form>
        </div>

        <div
          id="results"
          class="hidden glass-effect shadow-xl rounded-2xl p-8 animate-fade-in"
        >
          <div class="text-center mb-10">
            <div class="relative inline-block">
              <svg class="w-40 h-40">
                <circle
                  class="text-gray-200"
                  stroke-width="10"
                  stroke="currentColor"
                  fill="transparent"
                  r="60"
                  cx="80"
                  cy="80"
                />
                <circle
                  class="progress-ring text-blue-600"
                  stroke-width="10"
                  stroke="currentColor"
                  fill="transparent"
                  r="60"
                  cx="80"
                  cy="80"
                />
              </svg>
              <div class="absolute inset-0 flex items-center justify-center">
                <span
                  id="scoreValue"
                  class="text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"
                  >0%</span
                >
              </div>
            </div>
            <h2 class="mt-6 text-3xl font-bold text-gray-800">Match Score</h2>
          </div>

          <div class="space-y-8">
            <div
              class="bg-white rounded-xl p-6 shadow-md transition-all duration-300 hover:shadow-lg"
            >
              <h3 class="text-xl font-semibold text-gray-800 mb-4">
                Matching Skills
              </h3>
              <div id="matchingSkills" class="flex flex-wrap gap-2"></div>
            </div>

            <div
              class="bg-white rounded-xl p-6 shadow-md transition-all duration-300 hover:shadow-lg"
            >
              <h3 class="text-xl font-semibold text-gray-800 mb-4">
                Missing Skills
              </h3>
              <div id="missingSkills" class="flex flex-wrap gap-2"></div>
            </div>
          </div>
        </div>
      </div>
      <h3
        class="text-center text-lg text-gray-600 mt-8"
        style="margin-bottom: 15px"
      >
        By Vignesh.S
      </h3>
    </div>

    <script>
      // Handle file upload UI
      const uploadArea = document.querySelector(".upload-area");
      const fileInput = document.querySelector("#resume");
      const fileNameDisplay = document.querySelector("#fileName");

      uploadArea.addEventListener("click", () => fileInput.click());
      uploadArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        uploadArea.classList.add("border-blue-500", "bg-blue-50");
      });
      uploadArea.addEventListener("dragleave", () => {
        uploadArea.classList.remove("border-blue-500", "bg-blue-50");
      });
      uploadArea.addEventListener("drop", (e) => {
        e.preventDefault();
        uploadArea.classList.remove("border-blue-500", "bg-blue-50");
        fileInput.files = e.dataTransfer.files;
        updateFileName();
      });
      fileInput.addEventListener("change", updateFileName);

      function updateFileName() {
        const file = fileInput.files[0];
        fileNameDisplay.textContent = file
          ? file.name
          : "Drop your resume here or click to upload";
        if (file) {
          fileNameDisplay.classList.add("text-blue-600");
        } else {
          fileNameDisplay.classList.remove("text-blue-600");
        }
      }

      // Handle form submission
      document
        .getElementById("uploadForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const formData = new FormData();
          formData.append("resume", fileInput.files[0]);
          formData.append(
            "jobDescription",
            document.getElementById("jobDescription").value
          );

          try {
            const submitButton = e.target.querySelector(
              'button[type="submit"]'
            );
            submitButton.disabled = true;
            submitButton.innerHTML =
              '<span class="animate-pulse">Analyzing...</span>';

            const response = await fetch("/analyze", {
              method: "POST",
              body: formData,
            });

            if (!response.ok) throw new Error("Analysis failed");

            const data = await response.json();
            displayResults(data);
          } catch (error) {
            alert("Error analyzing resume: " + error.message);
          } finally {
            const submitButton = e.target.querySelector(
              'button[type="submit"]'
            );
            submitButton.disabled = false;
            submitButton.innerHTML = "Analyze Resume";
          }
        });

      function displayResults(data) {
        // Show results section with animation
        const results = document.getElementById("results");
        results.classList.remove("hidden");
        results.classList.add("animate-fade-in");

        // Update score with animation
        const score = data.score;
        const scoreValue = document.getElementById("scoreValue");
        const circle = document.querySelector(".progress-ring");
        const radius = circle.r.baseVal.value;
        const circumference = radius * 2 * Math.PI;
        circle.style.strokeDasharray = `${circumference} ${circumference}`;

        // Animate the score number
        let currentScore = 0;
        const duration = 1000; // 1 second animation
        const increment = score / (duration / 16); // 60fps
        const startTime = performance.now();

        function updateScore(currentTime) {
          const elapsed = currentTime - startTime;
          if (elapsed < duration) {
            currentScore = Math.min(score, currentScore + increment);
            scoreValue.textContent = `${Math.round(currentScore)}%`;
            circle.style.strokeDashoffset =
              circumference - (currentScore / 100) * circumference;
            requestAnimationFrame(updateScore);
          } else {
            scoreValue.textContent = `${score}%`;
            circle.style.strokeDashoffset =
              circumference - (score / 100) * circumference;
          }
        }
        requestAnimationFrame(updateScore);

        // Display skills with animation
        const matchingSkillsDiv = document.getElementById("matchingSkills");
        const missingSkillsDiv = document.getElementById("missingSkills");

        matchingSkillsDiv.innerHTML = data.matching_skills
          .map(
            (skill, index) =>
              `<span class="px-4 py-2 rounded-full text-sm font-medium bg-green-100 text-green-800 animate-fade-in" style="animation-delay: ${
                index * 100
              }ms">${skill}</span>`
          )
          .join("");

        missingSkillsDiv.innerHTML = data.missing_skills
          .map(
            (skill, index) =>
              `<span class="px-4 py-2 rounded-full text-sm font-medium bg-red-100 text-red-800 animate-fade-in" style="animation-delay: ${
                index * 100
              }ms">${skill}</span>`
          )
          .join("");

        // Smooth scroll to results
        results.scrollIntoView({ behavior: "smooth", block: "nearest" });
      }
    </script>
  </body>
</html>
